#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
Скрипт для добавления фоновой музыки к презентации
Создает видео из презентации с музыкальным сопровождением
"""

import os

# Инструкция по добавлению музыки
MUSIC_INSTRUCTIONS = """
=== Добавление музыки к презентации ===

Вариант 1: Встроенная музыка в PowerPoint
------------------------------------------
1. Откройте презентацию в PowerPoint
2. Перейдите на первый слайд
3. Вкладка "Вставка" -> "Звук" -> "Аудио на моем ПК"
4. Выберите музыкальный файл (MP3, WAV)
5. В параметрах воспроизведения установите:
   - Начало: Автоматически
   - Воспроизводить для всех слайдов
   - Скрыть при показе
   - Громкость: Средняя
6. Настройте длительность слайдов:
   - Вкладка "Слайд-шоу" -> "Настройка времени"
   - Установите время показа каждого слайда
   - Общее время должно быть 1.5-2 минуты

Вариант 2: Экспорт в видео с музыкой
-------------------------------------
1. Настройте автоматическую смену слайдов:
   - Вкладка "Переходы"
   - Установите время для каждого слайда (10-15 секунд)
   - Примените ко всем слайдам
2. Экспортируйте презентацию как видео:
   - Файл -> Экспорт -> Создать видео
   - Качество: Full HD (1080p)
   - Использовать записанные речевое сопровождение и время показа слайдов
3. Добавьте музыку к видео через видеоредактор

Рекомендуемая музыка:
--------------------
- Спокойная инструментальная музыка
- Корпоративная фоновая музыка
- Эмбиент или лаунж
- Классическая музыка (легкая)

Где найти бесплатную музыку:
----------------------------
1. YouTube Audio Library
2. Free Music Archive
3. Bensound.com
4. Incompetech.com
5. Purple Planet Music

Параметры музыки:
----------------
- Длительность: 1.5-2 минуты
- Темп: 60-80 BPM (медленный)
- Громкость: 20-30% от максимальной
- Формат: MP3 или WAV
- Битрейт: 128-320 kbps
"""

def print_music_instructions():
    print(MUSIC_INSTRUCTIONS)

def create_timing_file():
    """Создает файл с таймингами для слайдов"""
    timings = {
        "total_duration": 120,  # 2 минуты
        "slides": [
            {"slide": 1, "duration": 10, "transition": "fade"},
            {"slide": 2, "duration": 20, "transition": "push"},
            {"slide": 3, "duration": 20, "transition": "wipe"},
            {"slide": 4, "duration": 20, "transition": "fade"},
            {"slide": 5, "duration": 20, "transition": "push"},
            {"slide": 6, "duration": 20, "transition": "wipe"},
            {"slide": 7, "duration": 10, "transition": "fade"}
        ],
        "music": {
            "file": "background_music.mp3",
            "fade_in": 2,
            "fade_out": 3,
            "volume": 0.3
        }
    }

    import json
    with open("slide_timings.json", "w", encoding="utf-8") as f:
        json.dump(timings, f, indent=2)

    print("Файл с таймингами создан: slide_timings.json")

if __name__ == "__main__":
    print_music_instructions()
    create_timing_file()

    print("\n=== Следующие шаги ===")
    print("1. Выберите подходящую фоновую музыку")
    print("2. Скачайте музыкальный файл (1.5-2 минуты)")
    print("3. Переименуйте файл в 'background_music.mp3'")
    print("4. Следуйте инструкциям выше для добавления музыки")